<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.6: http://docutils.sourceforge.net/" />
<title>Acceleo User Guide</title>
<meta name="authors" content="Laurent Goubet  Laurent Delaigue" />
<link rel="stylesheet" href="../style/acceleo.css" type="text/css" />
</head>
<body>
<div class="document" id="acceleo-user-guide">
<h1 class="title">Acceleo User Guide</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Authors:</th>
<td>Laurent Goubet
<br />Laurent Delaigue</td></tr>
<tr><th class="docinfo-name">Contact:</th>
<td><a class="first last reference external" href="mailto:laurent.goubet&#64;obeo.fr">laurent.goubet&#64;obeo.fr</a></td></tr>
</tbody>
</table>
<p>Copyright © 2008, 2010 Obeo™.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id2">Introduction</a><ul>
<li><a class="reference internal" href="#pre-requisites" id="id3">Pre-requisites</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overview" id="id4">Overview</a><ul>
<li><a class="reference internal" href="#installation" id="id5">Installation</a></li>
<li><a class="reference internal" href="#eclipse-integration" id="id6">Eclipse Integration</a><ul>
<li><a class="reference internal" href="#the-acceleo-perspective" id="id7">The Acceleo Perspective</a></li>
</ul>
</li>
<li><a class="reference internal" href="#acceleo-projects" id="id8">Acceleo Projects</a><ul>
<li><a class="reference internal" href="#creating-an-acceleo-project-from-scratch" id="id9">Creating an Acceleo Project &quot;From Scratch&quot;</a></li>
<li><a class="reference internal" href="#creating-an-acceleo-ui-project" id="id10">Creating an Acceleo UI Project</a></li>
<li><a class="reference internal" href="#transforming-an-existing-project-into-an-acceleo-project" id="id11">Transforming an Existing Project into an Acceleo Project</a></li>
<li><a class="reference internal" href="#installing-an-example-acceleo-project" id="id12">Installing an Example Acceleo Project</a></li>
</ul>
</li>
<li><a class="reference internal" href="#acceleo-modules" id="id13">Acceleo Modules</a><ul>
<li><a class="reference internal" href="#imports" id="id14">Imports</a></li>
<li><a class="reference internal" href="#templates" id="id15">Templates</a><ul>
<li><a class="reference internal" href="#pre-conditions" id="id16">Pre-Conditions</a></li>
<li><a class="reference internal" href="#post-treatments" id="id17">Post-Treatments</a></li>
<li><a class="reference internal" href="#variable-initializations" id="id18">Variable Initializations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#queries" id="id19">Queries</a></li>
<li><a class="reference internal" href="#basic-language-constructs" id="id20">Basic Language Constructs</a><ul>
<li><a class="reference internal" href="#file-tags" id="id21">File Tags</a></li>
<li><a class="reference internal" href="#for-loops" id="id22">For Loops</a></li>
<li><a class="reference internal" href="#if-conditions" id="id23">If Conditions</a></li>
<li><a class="reference internal" href="#variables-let" id="id24">Variables : Let</a></li>
</ul>
</li>
<li><a class="reference internal" href="#main-modules-in-acceleo" id="id25">Main Modules in Acceleo</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#organizing-acceleo-modules" id="id26">Organizing Acceleo modules</a><ul>
<li><a class="reference internal" href="#naming-conventions" id="id27">Naming conventions</a></li>
<li><a class="reference internal" href="#design-your-module-as-you-would-for-apis" id="id28">Design your module as you would for APIs</a></li>
<li><a class="reference internal" href="#tests" id="id29">Tests</a></li>
<li><a class="reference internal" href="#tips-and-tricks" id="id30">Tips and Tricks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#edition" id="id31">Edition</a><ul>
<li><a class="reference internal" href="#the-acceleo-editor" id="id32">The Acceleo Editor</a></li>
<li><a class="reference internal" href="#editing-modules" id="id33">Editing modules</a><ul>
<li><a class="reference internal" href="#syntax-highlighting" id="id34">Syntax Highlighting</a></li>
<li><a class="reference internal" href="#content-assistant" id="id35">Content Assistant</a></li>
<li><a class="reference internal" href="#comments" id="id36">Comments</a></li>
<li><a class="reference internal" href="#code-folding" id="id37">Code Folding</a></li>
<li><a class="reference internal" href="#rapid-text-replacement" id="id38">Rapid Text Replacement</a></li>
<li><a class="reference internal" href="#rapid-for-if-blocks" id="id39">Rapid For/If Blocks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-acceleo-views" id="id40">The Acceleo Views</a><ul>
<li><a class="reference internal" href="#the-generation-patterns-view" id="id41">The Generation Patterns View</a></li>
<li><a class="reference internal" href="#the-overrides-view" id="id42">The Overrides View</a></li>
<li><a class="reference internal" href="#dynamic-overriding-vs-static-overriding" id="id43">Dynamic overriding vs static overriding</a></li>
<li><a class="reference internal" href="#the-result-view" id="id44">The Result View</a></li>
</ul>
</li>
<li><a class="reference internal" href="#outlines" id="id45">Outlines</a><ul>
<li><a class="reference internal" href="#the-dynamic-outline" id="id46">The Dynamic Outline</a></li>
<li><a class="reference internal" href="#the-quick-outline" id="id47">The Quick Outline</a></li>
</ul>
</li>
<li><a class="reference internal" href="#navigating-acceleo-modules" id="id48">Navigating Acceleo Modules</a><ul>
<li><a class="reference internal" href="#open-declaration" id="id49">Open Declaration</a></li>
<li><a class="reference internal" href="#search-references" id="id50">Search References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#detecting-and-solving-problems" id="id51">Detecting and Solving Problems</a><ul>
<li><a class="reference internal" href="#error-markers" id="id52">Error Markers</a></li>
<li><a class="reference internal" href="#quick-fixes" id="id53">Quick Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#refactoring" id="id54">Refactoring</a><ul>
<li><a class="reference internal" href="#renaming" id="id55">Renaming</a></li>
<li><a class="reference internal" href="#extract-as-template" id="id56">Extract as Template</a></li>
<li><a class="reference internal" href="#transform-to-protected-area" id="id57">Transform to Protected Area</a></li>
<li><a class="reference internal" href="#transform-to-for-if-block" id="id58">Transform to For/If Block</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-facilities" id="id59">Other Facilities</a><ul>
<li><a class="reference internal" href="#wrapping-java-services" id="id60">Wrapping Java Services</a></li>
<li><a class="reference internal" href="#initializing-a-project-with-an-example" id="id61">Initializing a Project with an Example</a></li>
<li><a class="reference internal" href="#migrating-acceleo-2-x-templates" id="id62">Migrating Acceleo 2.x templates</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#compilation" id="id63">Compilation</a><ul>
<li><a class="reference internal" href="#compilation-compliance-mode" id="id64">Compilation Compliance Mode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#execution" id="id65">Execution</a><ul>
<li><a class="reference internal" href="#running-an-acceleo-generation" id="id66">Running an Acceleo Generation</a><ul>
<li><a class="reference internal" href="#launch-acceleo-application" id="id67">Launch Acceleo Application</a></li>
<li><a class="reference internal" href="#launch-configurations" id="id68">Launch Configurations</a><ul>
<li><a class="reference internal" href="#execution-environment" id="id69">Execution environment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-generated-api" id="id70">The Generated API</a><ul>
<li><a class="reference internal" href="#customizing-acceleo-generations-with-properties" id="id71">Customizing Acceleo Generations with Properties</a></li>
<li><a class="reference internal" href="#generation-strategies" id="id72">Generation Strategies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-result-view" id="id73">Using the Result View</a></li>
<li><a class="reference internal" href="#standalone-execution" id="id74">Standalone Execution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#debugging-an-acceleo-generation" id="id75">Debugging an Acceleo Generation</a><ul>
<li><a class="reference internal" href="#breakpoints" id="id76">Breakpoints</a></li>
<li><a class="reference internal" href="#step-by-step-execution" id="id77">Step by Step Execution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#profiling-an-acceleo-generation" id="id78">Profiling an Acceleo Generation</a><ul>
<li><a class="reference internal" href="#profile-configurations" id="id79">Profile Configurations</a></li>
<li><a class="reference internal" href="#acceleo-profile-files" id="id80">Acceleo Profile Files</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#deployment" id="id81">Deployment</a><ul>
<li><a class="reference internal" href="#exporting-generator-projects-as-plug-ins" id="id82">Exporting Generator Projects as Plug-ins</a></li>
<li><a class="reference internal" href="#miscellaneous" id="id83">Miscellaneous</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h1><a class="toc-backref" href="#id2">Introduction</a></h1>
<div class="section" id="pre-requisites">
<h2><a class="toc-backref" href="#id3">Pre-requisites</a></h2>
<p>The reader should have a minimal knowledge about MDA concepts, the eclipse
platform, and the java language.</p>
</div>
</div>
<div class="section" id="overview">
<h1><a class="toc-backref" href="#id4">Overview</a></h1>
<p>Acceleo is the reference implementation of the OMG MTL Specification.
It is an Open-Source implementation, fully integrated in the eclipse platform,
though generations can also be run outside of eclipse.
Acceleo is fully compatible with the <a class="reference external" href="http://www.eclipse.org/modeling/emf/">Eclipse Modeling Framework</a>. Consequently, Acceleo is compatible
with any editor using EMF metamodels, like the eclipse UML implementations.</p>
<p>[PENDING - Links towards general MDA documentations]</p>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#id5">Installation</a></h2>
<p>The simplest way of installing Acceleo is to use a version of eclipse where it
is already installed!
Some versions of Eclipse Helios contain Acceleo, just pick your preferred
version at <a class="reference external" href="http://www.eclipse.org/downloads/">the eclipse download site</a>.</p>
<p>Otherwise, it is always possible to install Acceleo like any other feature in
eclipse. Use the <cite>Help &gt; Install New Software</cite> menu and use the official eclipse
Helios update site.</p>
</div>
<div class="section" id="eclipse-integration">
<h2><a class="toc-backref" href="#id6">Eclipse Integration</a></h2>
<p>Acceleo is fully integrated within the eclipse platform. This means that
editing, running, debugging can all be executed within eclipse, by using the
usual eclipse paradigms.
Let's first examine the main elements available for Acceleo in eclipse.</p>
<div class="section" id="the-acceleo-perspective">
<h3><a class="toc-backref" href="#id7">The Acceleo Perspective</a></h3>
<p>The Acceleo perspective allows users to work in an environment which provides
every facility to increase productivity while working with Acceleo.
For instance, Acceleo-specific menus are available by default in the Acceleo
perspective in order to make it easy to create projects or templates, and so on.</p>
<p>To switch to the Acceleo perspective, click on <em>Window &gt; Open Perspective &gt;
Other...</em>, select the perspective named <em>Acceleo</em> (Beware, if you have Acceleo
2.x installed, you may see two Acceleo perspectives available ; they can be
told apart with their icons).</p>
<img alt="../images/perspective_open.png" src="../images/perspective_open.png" />
<p>This perspective can also be opened with the &quot;perspectives&quot; button available on
the top right corner of eclipse.</p>
<img alt="../images/perspective_new_other.png" src="../images/perspective_new_other.png" />
<p>By default, the views displayed in the Acceleo perspective are:</p>
<ul class="simple">
<li>Package explorer;</li>
<li>Editor area (okay, it's not a view);</li>
<li>Outline;</li>
<li>Problems;</li>
<li>Error Log;</li>
<li>3 Acceleo-specific views:<ul>
<li>The Result view;</li>
<li>The Overrides view;</li>
<li>And the GenerationPatterns view.</li>
</ul>
</li>
</ul>
<img alt="../images/perspective_acceleo.png" src="../images/perspective_acceleo.png" />
<p>In the Acceleo perspective, the pop-up menu available on the package explorer
allows users to easily create Acceleo artifacts (such as projects or modules).</p>
<img alt="../images/perspective_popup_menu.png" src="../images/perspective_popup_menu.png" />
</div>
</div>
<div class="section" id="acceleo-projects">
<h2><a class="toc-backref" href="#id8">Acceleo Projects</a></h2>
<p>Acceleo projects are eclipse projects associated with the Acceleo nature.
Such projects contain Acceleo modules, java code, and anything required for the
needs of the code generation to achieve.</p>
<p><strong>Note:</strong> It is recommended to use a naming that respects the <a class="reference external" href="http://wiki.eclipse.org/Naming_Conventions">eclipse plug-ins
naming conventions</a>. Of course,
the name prefix has to be adapted to your specific context, but remember that
using a naming convention that prevents naming conflicts is a good idea.</p>
<div class="section" id="creating-an-acceleo-project-from-scratch">
<h3><a class="toc-backref" href="#id9">Creating an Acceleo Project &quot;From Scratch&quot;</a></h3>
<p>The aim of an Acceleo project is to generate text from a model (or from a set of
models).
For this tutorial, we will create a new Acceleo module for generating java beans
from a UML model.</p>
<img alt="../images/acceleo_userguide_uml_sample.png" src="../images/acceleo_userguide_uml_sample.png" />
<p>To create a new Acceleo project, right click on the package explorer view then
select <em>New-&gt;Acceleo Project</em>.</p>
<img alt="../images/new_acceleo_module_project.png" src="../images/new_acceleo_module_project.png" />
<p>Choose a correct plug-in name for the project, then click next.</p>
<img alt="../images/new_acceleo_module_project_1.png" src="../images/new_acceleo_module_project_1.png" />
<p>This wizard page allows you to initialize the project by creating one or
several Acceleo module files.</p>
<ul class="simple">
<li>Select the folder in which you want to create the new module file.</li>
<li>Fill in the module name</li>
<li>Optionally, you can select an existing file which will be copied into the new
module file. This could be useful to create a module from an existing &quot;target&quot;
file.</li>
<li>Then, select the metamodel from which your generation file will take its types
(in this example, UML)</li>
<li>Finally, choose the metaclass that will be used to generate the file (in this
example, Class). This can be modified later at any time directly in the module
files.</li>
</ul>
<p><strong>Note:</strong> Other options are available to initialize the new module with existing
content. These options will be discussed later.</p>
<img alt="../images/new_acceleo_module_project_2.png" src="../images/new_acceleo_module_project_2.png" />
<p>You can create more than one module file in this project by using the &quot;Add&quot;
button on the left.</p>
<p>Clicking on finish will create the module file(s), and some files automatically
generated from it (more on these below).</p>
<img alt="../images/new_acceleo_module_project_result.png" src="../images/new_acceleo_module_project_result.png" />
</div>
<div class="section" id="creating-an-acceleo-ui-project">
<h3><a class="toc-backref" href="#id10">Creating an Acceleo UI Project</a></h3>
<p>This action can only be performed on an existing Acceleo project.</p>
<p>It allows you to create and initialize a plug-in project that will contain
everything needed to launch the Acceleo generations of your project through
actions available in pop-up menus, integrated in eclipse.
This facilitates a lot the deployment of Acceleo generators in the eclipse
platform.
The created UI plug-in project is configured to create a popup menu on files with
a given extension and to generate files in a folder found by evaluating a java
expression, which can be customized.</p>
<p>To perform this, just right-click on your Acceleo project, then select
<em>Acceleo &gt; Create Acceleo UI Launcher Project</em>.</p>
<img alt="../images/acceleo_create_ui_launcher.png" src="../images/acceleo_create_ui_launcher.png" />
<p>This will start a wizard that will guide you through the creation process.
First, enter the target UI plug-in project name.</p>
<img alt="../images/acceleo_ui_launcher_wizard1.png" src="../images/acceleo_ui_launcher_wizard1.png" />
<p>Then, select the projects this UI plug-in will depend on. In our example, we only
depend on our Acceleo generator project, but in real life, an UI project could
require several Acceleo projects, plus optionally other projects depending on
your working environment.</p>
<img alt="../images/acceleo_ui_launcher_wizard2.png" src="../images/acceleo_ui_launcher_wizard2.png" />
<p>The wizard now requires the following information:</p>
<ul class="simple">
<li>The generator name (this name will be displayed to users in the UI);</li>
<li>The model filename filter, which indicates on which file extensions the popup
menu will appear;</li>
<li>The java code that is responsible to find the target folder and assign it to a
<tt class="docutils literal">target</tt> variable of type <tt class="docutils literal">IContainer</tt>.
By default, the wizard proposes some code which uses the <tt class="docutils literal"><span class="pre">src-gen</span></tt> folder in
the project that contains the model chosen by the user.</li>
</ul>
<img alt="../images/acceleo_ui_launcher_wizard3.png" src="../images/acceleo_ui_launcher_wizard3.png" />
<p>Click on <em>Finish</em>.</p>
<p>A new plug-in project is then created in the workspace with the previously
entered information. This plug-in can be maintained as any other plug-in project
in eclipse.</p>
<img alt="../images/acceleo_ui_launcher_wizard_result.png" src="../images/acceleo_ui_launcher_wizard_result.png" />
<p>To see this plug-in in action, just open the plug-in's MANIFEST.MF, and click on
the &quot;Launch an Eclipse application&quot; link in the &quot;Testing&quot; paragraph.</p>
<img alt="../images/acceleo_ui_launcher_launch.png" src="../images/acceleo_ui_launcher_launch.png" />
<p>A new action appears in the pop-up menu when right-clicking on files whose
name matches the name filter declared in the extension described in the
<tt class="docutils literal">plugin.xml</tt> file of the UI plug-in.</p>
<img alt="../images/acceleo_ui_project_in_action.png" src="../images/acceleo_ui_project_in_action.png" />
<p>By default, the generated UI plug-in matches any file.</p>
<p>The menu where the generation action appears and everything else can be adapted
to your needs via the eclipse extension mechanism.
For example, the name filter for which this action will be proposed can be
modified like this:</p>
<ul class="simple">
<li>Open the MANIFEST.MF file;</li>
<li>Go to the <em>Extensions</em> tab;</li>
</ul>
<img alt="../images/acceleo_ui_launcher_extension_tab.png" src="../images/acceleo_ui_launcher_extension_tab.png" />
<ul class="simple">
<li>Modify the <em>nameFilter</em> field of the <em>popupMenus</em> extension.</li>
</ul>
<p>For more information about the eclipse extension mechanism, please refer to the
eclipse Plug-in Development Environment (PDE) documentation.</p>
</div>
<div class="section" id="transforming-an-existing-project-into-an-acceleo-project">
<h3><a class="toc-backref" href="#id11">Transforming an Existing Project into an Acceleo Project</a></h3>
<p>Acceleo provides a facility to convert an existing project into an Acceleo
project.
Technically, this means that the <em>Acceleo nature</em> will be added to the project's
natures.</p>
<p>This can be achieved by right-clicking in the package explorer, then selecting
<em>New &gt; Convert to an Acceleo Project</em>.</p>
<img alt="../images/acceleo_convert_project.png" src="../images/acceleo_convert_project.png" />
<p>Select the project(s) that must be turned into Acceleo project(s), and click on
<em>Finish</em>.</p>
<img alt="../images/acceleo_convert_project_wizard.png" src="../images/acceleo_convert_project_wizard.png" />
<p><strong>Note:</strong> The <em>Acceleo nature</em> can be removed from an Acceleo project simply by
right-clicking on the project and selecting <em>Acceleo &gt; Remove Acceleo Nature</em>.</p>
<img alt="../images/acceleo_remove_acceleo_nature.png" src="../images/acceleo_remove_acceleo_nature.png" />
</div>
<div class="section" id="installing-an-example-acceleo-project">
<h3><a class="toc-backref" href="#id12">Installing an Example Acceleo Project</a></h3>
<p>Acceleo provides several example projects which you can use to get started and
take a look at how to organize generator projects.</p>
<p>To install one of these examples in your workspace, right-click in the package
explorer and select <em>New &gt; Other...</em>. Go to the &quot;Examples&quot; folder, then to
&quot;Acceleo Plug-ins&quot; and select the example to import into your workspace. Each
example has a small description displayed at the top of the window.</p>
<img alt="../images/acceleo_new_example.png" src="../images/acceleo_new_example.png" />
<p>Click on <em>Finish</em>, and one or several new projects appear in your workspace.</p>
<p>These example are really useful to start with Acceleo, so don't hesitate to
import them, examine them, and modify them!</p>
</div>
</div>
<div class="section" id="acceleo-modules">
<h2><a class="toc-backref" href="#id13">Acceleo Modules</a></h2>
<p>A module is a <tt class="docutils literal">.mtl</tt> file, which contains templates (to generate code) and/or
queries (to extract information from the manipulated models).</p>
<p>The file must start with the module declaration in the form</p>
<p><tt class="docutils literal">[module <span class="pre">&lt;module_name&gt;('metamodel</span> URI <span class="pre">1')]</span></tt></p>
<p>A module can <em>extend</em> another module, in which case its templates will be able
to <em>override</em> its parent's &quot;public&quot; and &quot;protected&quot; templates.</p>
<div class="section" id="imports">
<h3><a class="toc-backref" href="#id14">Imports</a></h3>
<p>An Acceleo module generally depends on other modules for its execution.
Consequently, Acceleo modules explicitly declare the modules they depend on via
<em>import</em> declarations.</p>
<p>The syntax is the following:</p>
<p><tt class="docutils literal">[import <span class="pre">qualified::name::of::imported::module</span> /]</tt></p>
<p>The content assistant (<em>Ctrl + Space</em>) will propose you all accessible modules.
Select the module you want to import and its qualified name will be inserted.</p>
<img alt="../images/acceleo_import.png" src="../images/acceleo_import.png" />
<p><em>Note:</em> It is possible to use a non-qualified name in an import, but this is
not recommended since it can easily lead to bugs that are hard to understand in
case of name conflicts between Acceleo modules.</p>
<p>The content assistant can be invoked to generate an import tag:
just enter <tt class="docutils literal">import</tt>, then <em>Ctrl + Space</em>, and the completion proposes
&quot;[import]&quot; and generates an <tt class="docutils literal">[import /]</tt> tag.</p>
<img alt="../images/acceleo_import_completion.png" src="../images/acceleo_import_completion.png" />
</div>
<div class="section" id="templates">
<h3><a class="toc-backref" href="#id15">Templates</a></h3>
<p>Templates are sets of Acceleo statements used to generate text. They are
delimited by <tt class="docutils literal"><span class="pre">[template]...[/template]</span></tt> tags.</p>
<img alt="../images/acceleo_simple_template.png" src="../images/acceleo_simple_template.png" />
<p>To create a new template, just place the cursor in an Acceleo module file at a
relevant position (<em>i.e.</em> one where it is possible to insert a template!) and
hit <em>Ctrl + Space</em>. The content assistant proposes, among other things, to
create a new template. It's also possible to type <tt class="docutils literal">template</tt>, <em>Ctrl + Space</em>,
then <em>Return</em>, and a new template is created:</p>
<img alt="../images/acceleo_content_assist_template1.png" src="../images/acceleo_content_assist_template1.png" />
<p>You can fill-in its name, parameter name, and parameter type. Just hit <em>Tab</em> to
pass from an element to the next.</p>
<img alt="../images/acceleo_content_assist_template2.png" src="../images/acceleo_content_assist_template2.png" />
<p>Templates can also have optional elements:</p>
<ul class="simple">
<li>Overriding (which will be detailed in <a class="reference internal" href="#the-overrides-view">The Overrides View</a>);</li>
<li>Pre-conditions (or guard conditions);</li>
<li>Post-treatments;</li>
<li>Variable initializations.</li>
</ul>
<p>Once again, the content assistant can help you here. just hit <em>Ctrl + Space</em>
before the final <tt class="docutils literal">]</tt> of your template declaration, and see what it proposes.</p>
<img alt="../images/acceleo_template_content_assist.png" src="../images/acceleo_template_content_assist.png" />
<div class="section" id="pre-conditions">
<h4><a class="toc-backref" href="#id16">Pre-Conditions</a></h4>
<p>Imagine you want to implement different behavior for a template depending on
certain conditions.</p>
<p>One way to do that would be to use <tt class="docutils literal">if</tt> blocks to distinguish between those
cases.</p>
<p>Another, more elegant, way is to use pre-conditions. Let's say that you want to
generate different code for associations whether or not they are declared
<em>ordered</em>.</p>
<img alt="../images/acceleo_template_precondition1.png" src="../images/acceleo_template_precondition1.png" />
<p>The above example shows the <tt class="docutils literal">? (condition)</tt> syntax that tells Acceleo that the
template must only be run if the pre-condition is satisfied.</p>
<p><strong>Note:</strong> The order of declaration of templates in a module is important: The
first template for which the guard condition evaluates to <strong>true</strong> will be
executed.
No guard condition on a template is exactly equivalent to <tt class="docutils literal">? (true)</tt>.</p>
<p><strong>Note:</strong> Pre-conditions also exist on <tt class="docutils literal">for</tt> blocks.</p>
</div>
<div class="section" id="post-treatments">
<h4><a class="toc-backref" href="#id17">Post-Treatments</a></h4>
<p>It is often useful, especially for code formatting, to apply certain treatments
on the text generated by a template before actually writing it to the output
file.</p>
<p>For instance, trimming the result of a template is really very useful to make
sure of your formatting while keeping a readable formatting for your templates.</p>
<p>Let's see an example to make things clear:</p>
<img alt="../images/acceleo_template_posttreatment.png" src="../images/acceleo_template_posttreatment.png" />
<p>In the above example, without the post-treatment <tt class="docutils literal">post <span class="pre">(trim())</span></tt>, the template
invocation would write the name <strong>followed by a carriage return</strong>. With the
post-treatment, whenever the template is called, it will just write the expected
name, without a carriage return, which is probably what you need.</p>
<p>The most common uses of post-treatments is output code formatting, thanks to
<tt class="docutils literal">post <span class="pre">(trim())</span></tt>. It's up to you to figure out what else you will use it for!</p>
</div>
<div class="section" id="variable-initializations">
<h4><a class="toc-backref" href="#id18">Variable Initializations</a></h4>
<p>Templates (and other blocks as well) can define some variables and initialize
them directly in their main syntactic block.</p>
<img alt="../images/acceleo_template_variable_init.png" src="../images/acceleo_template_variable_init.png" />
<p>You can declare 0, 1, or several variables. If you declare several variables, it
may be opportune to format the template this way:</p>
<img alt="../images/acceleo_template_variable_init_mult.png" src="../images/acceleo_template_variable_init_mult.png" />
<p><strong>Note:</strong> Variable initilization also exists on <tt class="docutils literal">for</tt> blocks.</p>
</div>
</div>
<div class="section" id="queries">
<h3><a class="toc-backref" href="#id19">Queries</a></h3>
<p>Queries are used to extract information from the model.
Queries return values, or collections of values.
They use OCL, enclosed in a <tt class="docutils literal">[query ... /]</tt> tag.</p>
<img alt="../images/acceleo_simple_query.png" src="../images/acceleo_simple_query.png" />
<p>Queries are specified to always return the same value each time they are invoked
with the same arguments.</p>
</div>
<div class="section" id="basic-language-constructs">
<h3><a class="toc-backref" href="#id20">Basic Language Constructs</a></h3>
<div class="section" id="file-tags">
<h4><a class="toc-backref" href="#id21">File Tags</a></h4>
<p>File tags are used to tell the Acceleo engine it must generate the content of
the <tt class="docutils literal">[file]</tt> tag in an actual file.</p>
<p>The syntax is the following:</p>
<p><tt class="docutils literal">[file (&lt;uri_expression&gt;, &lt;append_mode&gt;, <span class="pre">'&lt;output_encoding&gt;')]</span> <span class="pre">(...)</span> [/file]</tt></p>
<ul class="simple">
<li><tt class="docutils literal">&lt;uri_expression&gt;</tt> denotes the output file name;</li>
<li><tt class="docutils literal">&lt;append_mode&gt;</tt> (optional) indicates whether the output text must be
appended to the file or replace its content;</li>
<li><tt class="docutils literal">&lt;output_encoding&gt;</tt> (optional) indicates the encoding to use for the output
file. This encoding need not be the same as the module's encoding.</li>
</ul>
<p><strong>Note:</strong>
A template that contains a <tt class="docutils literal">[file]</tt> tag does not necessarily have an annotation
<tt class="docutils literal">&#64;main</tt>.
<tt class="docutils literal">&#64;main</tt> annotations are used to indicate to the Acceleo eclipse plug-in that
a java class must be generated to encapsulate the code required to run a
generation.
<tt class="docutils literal">&#64;main</tt> annotations can be placed on templates which have no <tt class="docutils literal">[file]</tt> tag,
but such templates must eventually call one or more templates that do have
<tt class="docutils literal">[file]</tt> tags if you want to get a result!</p>
<p>Please refer to
<a class="reference external" href="http://www.omg.org/spec/MOFM2T/1.0/">the official MTL Specification</a> for
more details.</p>
</div>
<div class="section" id="for-loops">
<h4><a class="toc-backref" href="#id22">For Loops</a></h4>
<p>For loops in Acceleo can be expressed with two syntaxes:</p>
<ul class="simple">
<li>The full syntax (conformant with the MTL specification): <tt class="docutils literal">[for (iterator :
Type | expression)] <span class="pre">(...)</span> [/for]</tt></li>
<li>The light syntax: <tt class="docutils literal">[for (expression)] <span class="pre">(...)</span> [/for]</tt></li>
</ul>
<p><strong>Note:</strong> When using the light syntax, an implicit variable <tt class="docutils literal">i</tt> is created,
which contains the index of current iteration, starting at 1.</p>
<p>Content assistant can be very helpful to make sure you use the right
syntax. For example, imagine that you want to insert a for loop, but you don't
remember for sure the Acceleo syntax for these loops.</p>
<p>Just type <tt class="docutils literal">for</tt> in the editor, then <em>Ctrl + Space</em>. Acceleo proposes the for
loop to be automatically inserted.</p>
<img alt="../images/acceleo_content_assist_forloop1.png" src="../images/acceleo_content_assist_forloop1.png" />
<p>Hit <em>Return</em> to confirm that you actually want to insert a for loop:</p>
<img alt="../images/acceleo_content_assist_forloop2.png" src="../images/acceleo_content_assist_forloop2.png" />
<p>You can now enter:</p>
<ul class="simple">
<li>The iterator variable name;</li>
<li>The iterator type;</li>
<li>The iterable expression.</li>
</ul>
<p>Just hit the <em>Tab</em> key to jump from one element to the next, as usual with
eclipse code templates.</p>
<p>Here is an example of a for loop to generate some code for each attribute of
a UML class:</p>
<img alt="../images/acceleo_content_assist_forloop3.png" src="../images/acceleo_content_assist_forloop3.png" />
<p>Finally, it is useful to know that it is possible to specify behavior to be run
before, between, or after each iteration of a for loop.</p>
<p>The content assistant proposes the corresponding options when invoked in the
declaration of a for loop, as can be seen on the picture below.</p>
<img alt="../images/acceleo_content_assist_forloop4.png" src="../images/acceleo_content_assist_forloop4.png" />
<p>The syntactic structure are respectively <tt class="docutils literal">before()</tt>, <tt class="docutils literal">separator()</tt>, and
<tt class="docutils literal">after()</tt>.</p>
<p><strong>Example:</strong></p>
<p><tt class="docutils literal">[for (Sequence{1, 2, 3}) before ('sequence: ') separator (', ') after <span class="pre">(';')]</span>
<span class="pre">[self/][/for]</span></tt></p>
<p>Will generate the following text:</p>
<p><tt class="docutils literal">sequence: 1, 2, 3;</tt></p>
</div>
<div class="section" id="if-conditions">
<h4><a class="toc-backref" href="#id23">If Conditions</a></h4>
<p>If conditions are written like this:</p>
<p><tt class="docutils literal">[if (condition)] <span class="pre">(...)</span> [/if]</tt></p>
<p>You can enter &quot;if&quot;, hit <em>Ctrl + Space</em>, then <em>Return</em>, and the Acceleo editor
will insert the right syntax so you just have to enter the condition expression.</p>
<p>And that's all there is to it!</p>
</div>
<div class="section" id="variables-let">
<h4><a class="toc-backref" href="#id24">Variables : Let</a></h4>
<p><strong>It is important to understand that variables in Acceleo are ``final``, which
means that their value cannot be changed after they have been initialized</strong>.</p>
<p><strong>Please also note that the Acceleo ``let`` hasn't got the same semantics as
the OCL ``let``.</strong></p>
<p>The syntax is the following:</p>
<p><tt class="docutils literal">[let variableName : VariableType = expression] <span class="pre">(...)</span> [/let]</tt></p>
<p>Where <tt class="docutils literal">variableName</tt> is the variable's name and <tt class="docutils literal">VariableType</tt> the
variable's type, and <tt class="docutils literal">expression</tt> is an expression which value will be
assigned to the variable if its type corresponds (Acceleo <tt class="docutils literal">let</tt> blocks are
equivalent to <tt class="docutils literal">if (expression.oclIsKindOf(VariableType)</tt>).</p>
<p>Variables only exist inside of a let block. Their lifetime consequently cannot
exceed that of their template. They are only visible inside of the let block,
which means that templates called within this block cannot &quot;see&quot; them. If you
need a sub-template to access a variable, you have to pass it as an argument.</p>
<p>Variables are especially useful to store a value and prevent computing it
several times in a row.</p>
<p>You can enter &quot;let&quot;, hit <em>Ctrl + Space</em>, then <em>Return</em>, and the Acceleo editor
will insert the right syntax so you just have to enter the variable name and
type.</p>
</div>
</div>
<div class="section" id="main-modules-in-acceleo">
<h3><a class="toc-backref" href="#id25">Main Modules in Acceleo</a></h3>
<p>&quot;Main&quot; Acceleo modules are entry points, that is to say modules which are used
to describe, in some way, the generation workflow.</p>
<p>Such modules can be created from standard acceleo modules, they just have to
<strong>contain the ``&#64;main`` annotation</strong>.</p>
<p>They <strong>do not necessary have to contain ``[file]`` tags</strong>: Main modules are the executable
modules, they need not be modules that actually generate files.</p>
<p>Nevertheless, Acceleo proposes a facility to create main modules.
Right-click in the package explorer, if possible on the package in which you
want to create a new main module though this is not necessary.
Select <em>New &gt; Other...</em> (or <em>Ctrl + N</em>).
Select <em>Acceleo Main Module File</em> in the <em>acceleo Model to Text</em> category.</p>
<img alt="../images/acceleo_new_main_module.png" src="../images/acceleo_new_main_module.png" />
<p>Click on <em>Next &gt;</em>.
Enter the name of the module to create (without the <tt class="docutils literal">.mtl</tt> extension) and
the folder in which it must be created, if the proposed folder is inconvenient.</p>
<img alt="../images/acceleo_new_main_module2.png" src="../images/acceleo_new_main_module2.png" />
<p>Click on <em>Next &gt;</em>.
Select the templates that this main module will call to actually generate files.</p>
<img alt="../images/acceleo_new_main_module3.png" src="../images/acceleo_new_main_module3.png" />
<p>Click on <em>Finish</em>.
A new Acceleo module is created, which contains the <tt class="docutils literal">&#64;main</tt> annotation and
consequently has a generated java file attached.
This module imports the modules that have been selected in the preceding
wizard page, and just calls them one after the other.</p>
<img alt="../images/acceleo_new_main_module4.png" src="../images/acceleo_new_main_module4.png" />
<p>You can now freely edit the content of this module to implement the workflow
you need. The created file is just an accelerator to initialize this task. It
will be sufficient in most cases but can be modified at will.</p>
</div>
</div>
</div>
<div class="section" id="organizing-acceleo-modules">
<h1><a class="toc-backref" href="#id26">Organizing Acceleo modules</a></h1>
<div class="section" id="naming-conventions">
<h2><a class="toc-backref" href="#id27">Naming conventions</a></h2>
<p>We recommend using naming conventions in your Acceleo modules, since it is an
easy way to achieve readability and thus improve maintainability. Such
conventions also prevent name conflicts.</p>
<p>The name of Acceleo projects should follow the following pattern:</p>
<p><em>&lt;namespace&gt;</em> <strong>.</strong> <em>&lt;input_metamodel&gt;</em> <strong>.gen.</strong> <em>&lt;target_architecture&gt;</em></p>
<p>For example, a project to generate .NET code from a UML model, developed by
Obeo, will be called <tt class="docutils literal">fr.obeo.uml.gen.dotnet</tt>.</p>
<p>Module file names and module names should start with a lowercase letter.</p>
<p>Module files should be located in packages with the same prefix as the project,
but feel free to create subpackages.</p>
<p>Template and query names should start with a lowercase letter, and use the
<tt class="docutils literal">camelCase</tt> convention just like methods in java (uppercase letters are used
to separate words).</p>
</div>
<div class="section" id="design-your-module-as-you-would-for-apis">
<h2><a class="toc-backref" href="#id28">Design your module as you would for APIs</a></h2>
<p>The usual design principles apply when designing Acceleo modules:
Maintainability, reusability, robustness are the objectives.
To reach them, organize your modules carefully:</p>
<ul class="simple">
<li>Use the visibility of templates and queries to define the public contract of
your modules;</li>
<li>Design the allowed dependencies between your modules in advance, and stick to
your design;</li>
<li>Document your modules, templates and queries!
Use <tt class="docutils literal">[comment]</tt> tags in the module's header to describe the module and
before each template and query to describe them;</li>
<li>Queries and templates should be small. Templates more than one page high
should be refactored as soon as possible;</li>
<li>Modules should be organized in a sensible way:<ul>
<li>One module per kind of file to generate, all located in a <tt class="docutils literal">main</tt> package;</li>
<li>Shared modules used by several others should be in a package called
<tt class="docutils literal">common</tt>;</li>
<li>Queries should be separated from templates, in their own package as well,
called <tt class="docutils literal">requests</tt>;</li>
</ul>
</li>
<li>Use guard conditions rather than multiple <tt class="docutils literal">if</tt> statements;</li>
<li>Prefer multiple small templates and queries to few larger templates/queries;</li>
<li>Do not directly use metamodel attributes to generate text, even if they seem
appropriate.</li>
</ul>
<p>Why this last one?
Because when you generate a piece of text, it captures a generation rule.
It often happens (espacially at the beginning of a module development) that
such rules are very simple, like &quot;write the class name&quot;.</p>
<p>And then the rule changes to become &quot;write the class name but make sure that
it starts with an uppercase letter, and that the resulting text is not a
reserved word, in which case, suffix it with an underscore&quot;.
And now you have to look for every place where you generate a class name in
your templates, and you do that all the time, and the correction is not only
tedious, but also very error-prone.</p>
<p>If this logic is captured from the very beginning in a dedicated template
whose responsability is to write a class name, you just have to modify this
one template and you're done.</p>
</div>
<div class="section" id="tests">
<h2><a class="toc-backref" href="#id29">Tests</a></h2>
<p>Of course, the importance of tests cannot be stressed enough.
Each Acceleo project should be accompanied by a test project that contains:</p>
<ul class="simple">
<li>Small models, each of them allowing you to test some particular generation rule;</li>
<li>The expected result for each model;</li>
<li>A main java class that runs all generations and ensures that the result is as
expected.</li>
</ul>
<p>Test projects have the same name as the project they test, suffixed by
<tt class="docutils literal">.test</tt>.</p>
</div>
<div class="section" id="tips-and-tricks">
<h2><a class="toc-backref" href="#id30">Tips and Tricks</a></h2>
<ul class="simple">
<li>Use <tt class="docutils literal">post <span class="pre">(trim())</span></tt> to properly format your templates and let them be
readable while making sure the generated text will also be properly formatted.</li>
<li>When navigating a reference that points to an interface, always implement a
default behavior on the target interface that will generate a warning text to
indicate a probable generation problem.
Then, implement the relevant behaviors on the interface subtypes.
This convention makes it easy to detect cases when an expected behavior is not
implemented;</li>
</ul>
<p>For example:</p>
<pre class="literal-block">
[template genJavaTypeName(c : Classifier) post (trim())]
/* TODO Implement template genJavaTypeName for type [eClass().name/] */
[/template]

[template genJavaTypeName(c : Class) post (trim())]
[name.toUpperFirst()/]
[/template]
</pre>
<p>This implementation makes sure that whenever you will invoke <tt class="docutils literal">genJavaTypeName</tt>
on an element of type &quot;Classifier&quot; or one of its subtypes, you will produce text
in the output file.
This will contain a warning message if you forgot something in the generator.</p>
<p>Do not implement each possible case of the different subtypes by testing the
type of the template's parameter!
Instead, let Acceleo dispatch the template invocation to the right template and
implement a template for each possible subtype.</p>
<p>Very often module developers expect to find only one of the possible
subtypes and forget to implement the behavior for other subtypes.
This pattern ensures that they will be warned as soon as they test their
generator on a model that contains what they did not expect.</p>
</div>
</div>
<div class="section" id="edition">
<h1><a class="toc-backref" href="#id31">Edition</a></h1>
<div class="section" id="the-acceleo-editor">
<h2><a class="toc-backref" href="#id32">The Acceleo Editor</a></h2>
<p>The module editor provides the following features:</p>
<ul class="simple">
<li>Syntax highlighting;</li>
<li>Content assistant (<em>Ctrl + Space</em>);</li>
<li>Error detection;</li>
<li>Quick fixes (<em>Ctrl + Shift + 1</em>);</li>
<li>Dynamic outline;</li>
<li>Quick outline (<em>Ctrl + O</em>);</li>
<li>Code folding;</li>
<li>Open declaration (either with <em>Ctrl + Left Click</em> or <em>F3</em>);</li>
<li>Search references (<em>Ctrl + Shift + G</em>).</li>
</ul>
<p>These features will be detailed hereafter.</p>
<p>For more information about the Acceleo syntax, please read the official OMG
specification accessible from <a class="reference external" href="http://www.omg.org/spec/MOFM2T/1.0/">the official MTL Specification</a>.</p>
</div>
<div class="section" id="editing-modules">
<h2><a class="toc-backref" href="#id33">Editing modules</a></h2>
<p>The Acceleo editor is by default associated with the <tt class="docutils literal">.mtl</tt> file extension.</p>
<div class="section" id="syntax-highlighting">
<h3><a class="toc-backref" href="#id34">Syntax Highlighting</a></h3>
<p>The editor uses specific colors for Acceleo templates:</p>
<ul class="simple">
<li>red is used for template tags;</li>
<li>purple is used for other tags (queries, modules, imports, ...);</li>
<li>blue is used for dynamic expressions in templates or other places;</li>
<li>green is used for comments and String literals;</li>
<li>black is used for static text or query bodies.</li>
</ul>
<img alt="../images/acceleo_simple_template.png" src="../images/acceleo_simple_template.png" />
</div>
<div class="section" id="content-assistant">
<h3><a class="toc-backref" href="#id35">Content Assistant</a></h3>
<p>The content assistant is traditionally invoked with <em>Ctrl + space</em>.
We have already met it severral times in this guide.
It proposes a choice of all elements that make sense at the place of invocation.
It is available everywhere, so don't hesitate to hit <em>Ctrl + space</em> anywhere!</p>
<p>Example of content assistant on a type:</p>
<img alt="../images/acceleo_content_assist_type.png" src="../images/acceleo_content_assist_type.png" />
<p>On a metamodel:</p>
<img alt="../images/acceleo_content_assist_metamodel.png" src="../images/acceleo_content_assist_metamodel.png" />
<p>Content assistant is also very useful in a multitude of situations. We will
give some examples, simply remember to hit <em>Ctrl + Space</em> whenever you want, it
will probably help you a lot!</p>
<p>Here is a view of all options you get when hitting <em>Ctrl + Space</em> in a template:</p>
<img alt="../images/acceleo_content_assistant.png" src="../images/acceleo_content_assistant.png" />
<p>And here is the options proposed out of a template, when hitting <em>Ctrl + Space</em>
directly in an Acceleo module file:</p>
<img alt="../images/acceleo_content_assistant_out.png" src="../images/acceleo_content_assistant_out.png" />
</div>
<div class="section" id="comments">
<h3><a class="toc-backref" href="#id36">Comments</a></h3>
<p>Comments are entered in <tt class="docutils literal">[comment]</tt> blocks, and appear in some shade of green.
The <tt class="docutils literal">[comment]</tt> tag can be self closed:</p>
<p><tt class="docutils literal">[comment Here is some comment of utter importance/]</tt></p>
<p>But you can also surround a block of text between comment tags:</p>
<pre class="literal-block">
[comment]
Here is some commented text, which cannot contain a right bracket character.
[/comment]
</pre>
<p>Such comments are part of the official MTL specification. They cannot be placed
inside OCL code, such as queries for instance. They cannot be placed in the
middle of an Acceleo statement either.</p>
<p>It is possible to comment some portion of code or text of an Acceleo module
with the <em>Ctrl + /</em> shortcut, or by right-clicking on the selected text and then
<em>Source &gt; Comment</em>.</p>
<p>The behavior depends on what is selected:</p>
<ul class="simple">
<li>If nothing is selected, the current line (not the line you right-clicked on,
but the line where the cursor is located) is surrounded with
<tt class="docutils literal"><span class="pre">[comment]...[\comment]</span></tt> tags.</li>
<li>If some text is selected, it is surrounded with <tt class="docutils literal"><span class="pre">[comment]...[\comment]</span></tt>
tags, whether it spans multiple lines or not.</li>
</ul>
</div>
<div class="section" id="code-folding">
<h3><a class="toc-backref" href="#id37">Code Folding</a></h3>
<p>Templates and comments can be folded thanks to a marker located in the left
margin in front of each of these elements.</p>
<img alt="../images/acceleo_code_folding.png" src="../images/acceleo_code_folding.png" />
</div>
<div class="section" id="rapid-text-replacement">
<h3><a class="toc-backref" href="#id38">Rapid Text Replacement</a></h3>
<p>Here is a very useful trick in Acceleo. Rapid text replacement allows you to
quickly replace all occurrence of a chosen piece of text by some template
invocation. Case differences are inferred generating <tt class="docutils literal">toUpper()</tt> or
<tt class="docutils literal">toUpperFirst()</tt> depending on what's needed.</p>
<p>Here is an example:</p>
<img alt="../images/acceleo_rapid_text_replacement1.png" src="../images/acceleo_rapid_text_replacement1.png" />
<p>In a classical bottom-up approach, you have written your code first, and you now
implement the Acceleo template from this code.
What you want to do here is to replace all occurrences of &quot;att1&quot; by a dynamic
behavior, <em>i.e.</em> by a template call.</p>
<p>The easiest way to do this is to select one of the &quot;att1&quot; in the editor, and
invoke the content assistant by hitting <em>Ctrl + Space</em>.</p>
<img alt="../images/acceleo_rapid_text_replacement2.png" src="../images/acceleo_rapid_text_replacement2.png" />
<p>The completion assistant proposes to replace all occurrences of the selected
text by a template call. A preview of the result is displayed in a tooltip close
to the completion window.</p>
<p>When you accept this option, all occurrences are replaced and you can
immediately enter the template invocation needed, which is simultaneously
replaced in all relevant locations.</p>
<img alt="../images/acceleo_rapid_text_replacement3.png" src="../images/acceleo_rapid_text_replacement3.png" />
<p>All occurrences of <tt class="docutils literal">att1</tt> have been replaced by <tt class="docutils literal"><span class="pre">[javaName()/]</span></tt> (because
<tt class="docutils literal">javaName()</tt> is what was entered manually), but <tt class="docutils literal">Att1</tt> has been replaced by
<tt class="docutils literal"><span class="pre">[javaName().toUpperFirst()/]</span></tt>.</p>
<p>The next thing you'd want to do in the above example is to replace all
occurrences of <tt class="docutils literal">int</tt> by something like <tt class="docutils literal"><span class="pre">[javaType()/]</span></tt>, and implement the
<tt class="docutils literal">javaType</tt> template to write the java type of the class attributes.</p>
<img alt="../images/acceleo_rapid_text_replacement4.png" src="../images/acceleo_rapid_text_replacement4.png" />
<p>Just proceed the same way and you're done. No risk to forget any occurrence of
your type anymore!</p>
<img alt="../images/acceleo_rapid_text_replacement5.png" src="../images/acceleo_rapid_text_replacement5.png" />
</div>
<div class="section" id="rapid-for-if-blocks">
<h3><a class="toc-backref" href="#id39">Rapid For/If Blocks</a></h3>
<p>You will probably not use this feature every day, but it is important to know
that it exists because it can bring you comfort from time to time.</p>
<p>[PENDING Find a meaningful example and document the feature.]</p>
</div>
</div>
<div class="section" id="the-acceleo-views">
<h2><a class="toc-backref" href="#id40">The Acceleo Views</a></h2>
<p>Acceleo provides a few specific views to improve productivity when working with
templates.
These views will be detailed later on, in the relevant chapters.
Let's just summarize their purpose to get the big picture.</p>
<p>As usual, they can be opened by clicking on <em>Window &gt; Show View</em> and selecting
the appropriate view in the menu. Note that in the Acceleo perspective, Acceleo
views are proposed by default directly in this menu, which will not be the case
in another perspective where you'll have to find them in the <em>Other...</em> popup.</p>
<div class="section" id="the-generation-patterns-view">
<h3><a class="toc-backref" href="#id41">The Generation Patterns View</a></h3>
<p>Generation patterns have been introduced in acceleo because we noticed that
something that happens really often when developing code generators is the need
to implement some behavior on an interface and all or part of its subtypes.</p>
<p>For example, let's imagine you are implementing a java generator from UML.
What you want is to have a template called <tt class="docutils literal">javaName</tt> which will generate the
name of any classifier, with some default behavior and some specific behavior on
classes and interfaces.</p>
<p>This is where the <strong>Generation Patterns</strong> view comes into play:</p>
<ul class="simple">
<li>Locate the cursor in the template, at the position where you want to insert
your <tt class="docutils literal">javaName</tt> templates;</li>
<li>In the Generation patterns view, select &quot;[template] for all selected types&quot; in
the top part</li>
<li>Select the types for which you want to create <tt class="docutils literal">javaName</tt> templates for.</li>
</ul>
<p>Note the bottom part of the Generation Patterns views presents a
hierarchical view of the metamodel you are using. Each node represents a type of
the metamodel and contains all of its subtypes. So, one type can appear several
times in this view, one time for each of its super-classes or super-interfaces.
When you select a node (by checking the combo-box before it), all its
descendants are also selected by default, but you can uncheck those you don't
need.</p>
<img alt="../images/acceleo_generation_patterns1.png" src="../images/acceleo_generation_patterns1.png" />
<p>Once you have selected the types you need, go back to the editor and activate
the completion by hitting <em>Ctrl+Space</em>. The first choice should be
&quot;[template] for all selected types&quot;, select it.</p>
<img alt="../images/acceleo_generation_patterns2.png" src="../images/acceleo_generation_patterns2.png" />
<p>New templates are then inserted into you Acceleo module. They are called &quot;name&quot;
by default but you can immediately rename them by just entering the name you
want. All templates will be renamed simultaneously.</p>
<img alt="../images/acceleo_generation_patterns3.png" src="../images/acceleo_generation_patterns3.png" />
<p>Here, Acceleo has done his job, now it's time for you to do yours: implement
these newly created templates!</p>
</div>
<div class="section" id="the-overrides-view">
<h3><a class="toc-backref" href="#id42">The Overrides View</a></h3>
<p>This view presents you with every Acceleo element that is accessible in your
workbench (no matter your current project's dependencies). You can select
one or several elements (use the checkboxes) and override them.</p>
<p><strong>Note:</strong> If the meaning of &quot;override&quot; is not clear, you may want to refer to
the <a class="reference external" href="http://www.omg.org/spec/MOFM2T/1.0/">official MTL Specification</a>.</p>
<p>Templates displayed in this view can be anywhere in your workspace or in your
plug-ins.</p>
<p>So, this view can be used for:</p>
<ul class="simple">
<li>Selecting templates you want to override (which is its main purpose);</li>
<li>Navigating to templates in your plug-ins to see their implementation without
having to explicitly import their plug-in(s) in your workspace.</li>
</ul>
<p>To override one or several existing templates, just select them in this view by
checking their checkboxes. Then, edit the module in which you will override the
templates, place the cursor where you want to insert the overriding templates,
and hit <em>Ctrl + Space</em>.</p>
<img alt="../images/acceleo_overrides_view2.png" src="../images/acceleo_overrides_view2.png" />
<p>Select the first choice (&quot;Selected Overrides&quot;) and hit <em>Return</em>.
The overriding templates are then created. Note that by default, their
implementation is initialized with their original implementation.</p>
<img alt="../images/acceleo_overrides_view3.png" src="../images/acceleo_overrides_view3.png" />
<p><strong>Note:</strong> A marker indicates whether a given project is accessible from yours.
If this is the case, a green mark indicates everything is fine.
Otherwise, a red marker indicates that you need to import the project in yours
to be able to override a template it contains.
For example, in the screenshot below,
<tt class="docutils literal">org.eclipse.acceleo.module.other.sample</tt> needs be imported in your current
project before you can successfully override one of its templates.</p>
<img alt="../images/acceleo_overrides_view1.png" src="../images/acceleo_overrides_view1.png" />
<p>Nevertheless, you <strong>can</strong> declare the overriding, it will just <strong>not compile</strong>
while you have not imported the relevant project (which is done in the
<tt class="docutils literal">MANIFEST.MF</tt> file of your Acceleo project).</p>
</div>
<div class="section" id="dynamic-overriding-vs-static-overriding">
<h3><a class="toc-backref" href="#id43">Dynamic overriding vs static overriding</a></h3>
<p>Acceleo allows static overriding as described in the MTL specification.
Acceleo also allows another kind of overriding, which is called &quot;dynamic&quot;.</p>
<p>Dynamic overriding allows you to override any template called by a given module
even if the launcher of this module knows nothing about your project.
It takes precedence over any static template overriding.
With dynamic overriding, you can make sure a specific template will be called
while calling the original generator (the initial java class that launches the
generation).
Dynamic overriding only works &quot;out-of-the-box&quot; inside of eclipse.</p>
<p>To activate dynamic overriding, you must place the overriding template on a
plug-in which will extend the <tt class="docutils literal">org.eclipse.acceleo.engine.dynamic.templates</tt>
extension point.</p>
<p>To do that, open the <tt class="docutils literal"><span class="pre">META-INF/MANIFEST.MF</span></tt> file of your plug-in, go to the
<em>Extensions</em> tab, and click on the &quot;Add...&quot; button.</p>
<img alt="../images/acceleo_dynamic_override_extension.png" src="../images/acceleo_dynamic_override_extension.png" />
<p>Click on &quot;Finish&quot;.</p>
<p>The extension point requires only one piece of information, which is the path to
a module file or folder.
If it is a folder, Acceleo looks for modules recursively and takes them all into
account for dynamic overriding.</p>
<p>You can use the &quot;Browse...&quot; button to select the file or folder.</p>
<img alt="../images/acceleo_dynamic_override_browse.png" src="../images/acceleo_dynamic_override_browse.png" />
<p><strong>Note:</strong> Your plug-in must be a singleton to declare an extension.</p>
</div>
<div class="section" id="the-result-view">
<h3><a class="toc-backref" href="#id44">The Result View</a></h3>
<p>This view displays the results of the latest generation run.
It displays the list of projects where some code has been generated.
In each project, the files that have been generated (in their folders).</p>
<p>For each file, the view displays:</p>
<ul class="simple">
<li>A list of model elements used for their generation, in a hierarchical way;</li>
<li>A list of Acceleo modules used for their generation.</li>
</ul>
<p>You can double-click on any element to visualize the related portions of
generated text.</p>
<p>You can right-click on any element and select <em>Open Declaration</em> to navigate
to any atomic element used during the generation, be it a model element or an
Acceleo element (template, query).</p>
<p>This view's behavior will be further detailed in chapter
<a class="reference internal" href="#using-the-result-view">Using the Result View</a>.</p>
</div>
</div>
<div class="section" id="outlines">
<h2><a class="toc-backref" href="#id45">Outlines</a></h2>
<div class="section" id="the-dynamic-outline">
<h3><a class="toc-backref" href="#id46">The Dynamic Outline</a></h3>
<p>The traditional eclipse outline view is used by Acceleo to display the module's
structure. imports, templates, queries can be seen there, and double-clicking on
any of them places the cursor at the corresponding position in the module (in
the editor).</p>
<img alt="../images/acceleo_dynamic_outline.png" src="../images/acceleo_dynamic_outline.png" />
</div>
<div class="section" id="the-quick-outline">
<h3><a class="toc-backref" href="#id47">The Quick Outline</a></h3>
<p>The quick outline, which can be displayed using <em>Ctrl + O</em>, displays just the
necessary information to access any element in the current module.
So, hitting <em>Ctrl + O</em> displays a pop-up with a list of templates and queries.</p>
<img alt="../images/acceleo_quick_outline.png" src="../images/acceleo_quick_outline.png" />
<p>A text field at the top allows you to quickly filter the content in order to
easily find what you are looking for.</p>
</div>
</div>
<div class="section" id="navigating-acceleo-modules">
<h2><a class="toc-backref" href="#id48">Navigating Acceleo Modules</a></h2>
<p>One of the great benefits of modern IDE tooling is the capacity to easily
navigate in code from elements to their declarations and, vice-versa, from
declarations to usages.</p>
<p>These features are available in Acceleo.</p>
<div class="section" id="open-declaration">
<h3><a class="toc-backref" href="#id49">Open Declaration</a></h3>
<p>The traditional shortcut <em>F3</em> is supported by Acceleo, along with <em>Ctrl +
click</em>, which both take you to the declaration of the selected or clicked
element.
This is supported for all kinds of elements: templates, queries, metamodels,
metamodel elements, EOperations, etc.</p>
<p>This can also be achieved by right-clicking on an element, then <em>Open
Declaration</em>.</p>
</div>
<div class="section" id="search-references">
<h3><a class="toc-backref" href="#id50">Search References</a></h3>
<p>Conversely, it is possible to get all the elements that refer to a given element.
The shortcut is <em>Ctrl + Shift + G</em>, but it can also be achieved by right-clicking
on the element then <em>Search References</em>.</p>
<p>The relevant elements are displayed in the Search view.</p>
</div>
</div>
<div class="section" id="detecting-and-solving-problems">
<h2><a class="toc-backref" href="#id51">Detecting and Solving Problems</a></h2>
<div class="section" id="error-markers">
<h3><a class="toc-backref" href="#id52">Error Markers</a></h3>
<p>Obviously, Acceleo displays error markers when errors are detected.
Error markers also appear in the eclipse Problems view, as usual. Files with
errors also appear with an error decorator.</p>
<p>Just hover the marker in the editor margin with the mouse to get a tooltip to
appear with an explanation of the problem.</p>
<img alt="../images/acceleo_error_marker.png" src="../images/acceleo_error_marker.png" />
<p>Acceleo displays error markers whenever a module file cannot be compiled,
whatever the reason. But more, Acceleo also displays error markers when it finds
inconsistencies between a module and other elements, such as the containing
plug-in's <tt class="docutils literal">MANIFEST.MF</tt> file.
For instance, if a module's main file is located in a package which is not
exported by its plug-in, an error marker is added because the main file cannot
be run if the plug-in does not export its package.</p>
<p>Errors appear in the &quot;Problems&quot; view (generally displayed at the bottom of the
perspective), and double-clicking on an error in this view directly takes you
to the file where it is located.</p>
<img alt="../images/acceleo_error_synchro.png" src="../images/acceleo_error_synchro.png" />
<p>In the example above, the <tt class="docutils literal"><span class="pre">[javaName()]</span></tt> tag is never closed. Just replace it
with <tt class="docutils literal"><span class="pre">[javaName()/]</span></tt> (notice the slash to close the tag) and the error
disappears.</p>
</div>
<div class="section" id="quick-fixes">
<h3><a class="toc-backref" href="#id53">Quick Fixes</a></h3>
<p>Quick fixes are available with the shortcut <em>Ctrl + 1</em>.</p>
<p>Currently, quick fixes propose to create a supposedly missing template or query,
before or after the current template.</p>
<p>In the following example, we just write the call to a template that does not
exist yet, and use the quick fix to create it immediately.</p>
<img alt="../images/acceleo_quick_fixes.png" src="../images/acceleo_quick_fixes.png" />
<p>Another quick fix available creates a new query that wraps a java service, as
described in the <a class="reference internal" href="#wrapping-java-services">Wrapping Java Services</a> section.</p>
<p>Imagine you have java methods called <tt class="docutils literal">service1</tt>, <tt class="docutils literal">service2</tt>, <tt class="docutils literal">service3</tt>
(which of course are not recommended names!) in a class that you can access
from your Acceleo project (it is either directly in your project, or imported).
Enter <tt class="docutils literal">service</tt> in your template and save it.
A red marker appears since it does not compile.</p>
<p>Hit <em>Ctrl + 1</em>, and select <em>Create Java service wrapper</em>.</p>
<img alt="../images/acceleo_quick_fix_service_wrapper1.png" src="../images/acceleo_quick_fix_service_wrapper1.png" />
<p>Acceleo looks for a method starting by &quot;service&quot; in the accessible classes and
creates queries for each of them, inserting them at the end of your module file.</p>
<img alt="../images/acceleo_quick_fix_service_wrapper2.png" src="../images/acceleo_quick_fix_service_wrapper2.png" />
<p><strong>Note:</strong> More quick fixes will be provided in the next versions of Acceleo.</p>
</div>
</div>
<div class="section" id="refactoring">
<h2><a class="toc-backref" href="#id54">Refactoring</a></h2>
<div class="section" id="renaming">
<h3><a class="toc-backref" href="#id55">Renaming</a></h3>
<p>The renaming functionality is accessible via <em>Alt + Shift + R</em>, as usual in
eclipse.
This allows templates and variables to be renamed in a coherent manner: All
references to the renamed element are updated to use the new name, as expected.</p>
<p>Note that when selecting an element in the editor, all the occurrences of the
same element are highlighted, which makes it very easy to find where a given
template is being used.</p>
<p>When hitting <em>Alt + Shift + R</em>, a window appears where the new name must be
entered.
Names already in use are forbidden.</p>
<p>From here, it is possible to preview the changes that will be made by clicking
on the <em>Preview &gt;</em> button, or to make the changes immediately by clicking on
<em>OK</em>.</p>
<img alt="../images/acceleo_rename.png" src="../images/acceleo_rename.png" />
<p>The preview displays the files that will be modified and for each of them the
changes that are to be applied to their content.</p>
<img alt="../images/acceleo_rename_preview.png" src="../images/acceleo_rename_preview.png" />
<p>The left side of the preview displays the current state of the module, and the
right side displays the future state of the module after the renaming takes
place.</p>
</div>
<div class="section" id="extract-as-template">
<h3><a class="toc-backref" href="#id56">Extract as Template</a></h3>
<p>When you develop Acceleo templates, you will sooner or later (and probably
sooner than later) wish to extract a piece of code into a template in order to
prevent the copy/paste syndrom.</p>
<p>Well, don't worry : you can do it with no effort!</p>
<p>Just select the piece of text you want to extract in another template, and
right-click then choose <em>Refactor &gt; Extract Template</em> (or just hit <em>Alt + Shift
+ T</em>).</p>
<img alt="../images/acceleo_extract_template_before.png" src="../images/acceleo_extract_template_before.png" />
<p>The selected text is then extracted in another template. Note that the selected
text needs to be consistent : you cannot of course extract text that partially
spans blocks of code and get an adequate result.</p>
<img alt="../images/acceleo_extract_template_after.png" src="../images/acceleo_extract_template_after.png" />
</div>
<div class="section" id="transform-to-protected-area">
<h3><a class="toc-backref" href="#id57">Transform to Protected Area</a></h3>
<p>Similarly, it is very useful to mark some code area as protected.
For example, in the following code, it may be useful to protect the imports area
in order to keep imports required by user code after each regeneration.</p>
<img alt="../images/acceleo_mark_as_protected1.png" src="../images/acceleo_mark_as_protected1.png" />
<p>Rather than manually entering the <tt class="docutils literal">[protected]</tt> blocks, you can just select
the portion of code to protect, right-click on it then choose <em>Source &gt; As
Protected Area...</em> (or use the <em>Alt + Shift + P</em> shortcut).</p>
<img alt="../images/acceleo_mark_as_protected2.png" src="../images/acceleo_mark_as_protected2.png" />
<p>The selected text is then surrounded with <tt class="docutils literal">[protected]</tt> markers, with an
automatically inferred id.</p>
<img alt="../images/acceleo_mark_as_protected3.png" src="../images/acceleo_mark_as_protected3.png" />
<p>Don't forget to add the comment markers at the beginning of the protected lines.
Since such comment markers depend on your target language, Acceleo cannot infer
them (we use java for this document's examples).</p>
<img alt="../images/acceleo_mark_as_protected4.png" src="../images/acceleo_mark_as_protected4.png" />
<p><strong>Note:</strong> You may have to modify the id used to make sure the marker works like
you want, as ids have to be unique for a given file.</p>
</div>
<div class="section" id="transform-to-for-if-block">
<h3><a class="toc-backref" href="#id58">Transform to For/If Block</a></h3>
<p>[PENDING]</p>
</div>
</div>
<div class="section" id="other-facilities">
<h2><a class="toc-backref" href="#id59">Other Facilities</a></h2>
<div class="section" id="wrapping-java-services">
<h3><a class="toc-backref" href="#id60">Wrapping Java Services</a></h3>
<p>It is sometimes useful to invoke some java code from inside an Acceleo template.
The acceleo non-standard library provides a service <cite>invoke</cite> which allows just
that. The invoked java service can be wrapped in an Acceleo query.</p>
<p>To facilitate the creation of such a wrapper, proceed like this:</p>
<ol class="arabic">
<li><p class="first">Right-click on the package you want to create your Acceleo module in, and
select <em>New &gt; Acceleo Module File</em></p>
<img alt="../images/acceleo_services_wrapper1.png" src="../images/acceleo_services_wrapper1.png" />
</li>
<li><p class="first">In the wizard, enter the relevant information in the usual fields, then click
on the <em>Advanced &gt;&gt;</em> button</p>
</li>
<li><p class="first">Check the <em>Initialize Content</em> checkbox</p>
</li>
<li><p class="first">Select <em>Create a Java services wrapper</em> in the listbox below</p>
<img alt="../images/acceleo_services_wrapper2.png" src="../images/acceleo_services_wrapper2.png" />
</li>
<li><p class="first">Select the java file that contains the services to wrap</p>
<img alt="../images/acceleo_services_wrapper3.png" src="../images/acceleo_services_wrapper3.png" />
</li>
<li><p class="first">Click on the <em>Finish</em> button</p>
<img alt="../images/acceleo_services_wrapper4.png" src="../images/acceleo_services_wrapper4.png" />
</li>
</ol>
<p>That's it!</p>
<p>An Acceleo module is created, with a query for each service found in the
original java class.</p>
<img alt="../images/acceleo_services_wrapper5.png" src="../images/acceleo_services_wrapper5.png" />
</div>
<div class="section" id="initializing-a-project-with-an-example">
<h3><a class="toc-backref" href="#id61">Initializing a Project with an Example</a></h3>
<p>It is often useful (actually, it is recommended) to use a bottom-up approach
to develop Acceleo templates.
So, before beginning to write templates, start by prototyping your target files,
make sure they work as expected, and then you are ready to start generating them.
An existing application can be used as a starting point to create an Acceleo
module.
By the way, it is a good idea to mimick the target's organization in the Acceleo
module's organization: One generation module per kind of file to generate, each
located in a package named after the target package's name.</p>
<p>At that time, you'd like to import the content of some files into a new template.</p>
<p>Let's imagine you have written the following class sample in your bottom-up
approach. (Of course, this is a stupid example, you'll have to work a bit more
for this approach to prove useful!)</p>
<img alt="../images/acceleo_from_sample1.png" src="../images/acceleo_from_sample1.png" />
<ol class="arabic">
<li><p class="first">Right-click on the package you want to create your Acceleo module in, and
select <em>New &gt; Acceleo Module File</em></p>
<img alt="../images/acceleo_from_sample2.png" src="../images/acceleo_from_sample2.png" />
</li>
<li><p class="first">In the wizard, enter the relevant information in the usual fields, then click
on the <em>Advanced &gt;&gt;</em> button</p>
<img alt="../images/acceleo_from_sample3.png" src="../images/acceleo_from_sample3.png" />
</li>
<li><p class="first">Check the <em>Initialize Content</em> checkbox</p>
</li>
<li><p class="first">Select <em>Copy example content</em> in the listbox below (which should be selected
by default)</p>
</li>
<li><p class="first">select the file that contains the example code</p>
<img alt="../images/acceleo_from_sample4.png" src="../images/acceleo_from_sample4.png" />
</li>
<li><p class="first">Click on the <em>Finish</em> button</p>
</li>
</ol>
<img alt="../images/acceleo_from_sample5.png" src="../images/acceleo_from_sample5.png" />
<p>An Acceleo module is created, and the content of the example java file is copied
into this module's primary template.</p>
<img alt="../images/acceleo_from_sample6.png" src="../images/acceleo_from_sample6.png" />
<p><strong>Note:</strong> You may have noticed that error marker at the top left of the Acceleo
editor area. This is due to the package containing the newly created module not
being declared as exported by the plug-in.
It is necessary to add relevant packages to the exported packages list
in your plug-in's <tt class="docutils literal">MANIFEST.MF</tt> file. Especially, templates that contain an
<tt class="docutils literal">&#64;main</tt> annotation and are located in a package which is not exported are
marked with an error marker to remind you that.</p>
<img alt="../images/acceleo_add_exported_packages.png" src="../images/acceleo_add_exported_packages.png" />
<p>Declaring the package as exported by the plug-in removes the error marker, all is
well that ends well.</p>
</div>
<div class="section" id="migrating-acceleo-2-x-templates">
<h3><a class="toc-backref" href="#id62">Migrating Acceleo 2.x templates</a></h3>
<p><strong>Warning: This feature will probably evolve in future versions.</strong></p>
<p><strong>Important note: It is necessary to use a version of eclipse &gt;= 3.5 in order
to successfully convert Acceleo 2.x projects or templates into Acceleo 3
modules.</strong></p>
<p>[PENDING]</p>
</div>
</div>
</div>
<div class="section" id="compilation">
<h1><a class="toc-backref" href="#id63">Compilation</a></h1>
<p>Acceleo templates are compiled into models, materialized by <tt class="docutils literal">.emtl</tt> files in
the <tt class="docutils literal">bin/</tt> folder of Acceleo projects.</p>
<p>Of course, Acceleo complies to eclipse settings for compilation, which means
that compiled files are placed in the default output folder as defined in the
Java Build Path settings of the package (usually the <tt class="docutils literal">bin/</tt> folder).</p>
<div class="section" id="compilation-compliance-mode">
<h2><a class="toc-backref" href="#id64">Compilation Compliance Mode</a></h2>
<p>The Acceleo compiler can be set to be &quot;strict&quot; or &quot;pragmatic&quot;, &quot;pragmatic&quot; being
the default mode.</p>
<p>The &quot;strict&quot; mode is 100% compliant with the OMG specification and guarantees
that the compiled generators will work in any MTL-compilant engine. In this
case, non-standard libraries are not allowed.</p>
<p>The &quot;pragmatic&quot; mode is not 100% MTL-compliant since non-standard libary operations
are allowed, but this makes it way easier to develop powerful modules.</p>
<p>This can be set project by project in each project's properties page:</p>
<img alt="../images/acceleo_compiler_compliance.png" src="../images/acceleo_compiler_compliance.png" />
<p>Just select the project and click <em>Alt + Return</em>, or right-click on it and
select <em>Properties</em>.</p>
<p>Check the &quot;Strict MTL Compliance&quot; option to activate the strict mode, which is
off by default.</p>
</div>
</div>
<div class="section" id="execution">
<h1><a class="toc-backref" href="#id65">Execution</a></h1>
<div class="section" id="running-an-acceleo-generation">
<h2><a class="toc-backref" href="#id66">Running an Acceleo Generation</a></h2>
<p>There are several ways of launching a generation with Acceleo. We will now
examine how to generate code inside eclipse, then outside of eclipse.</p>
<div class="section" id="launch-acceleo-application">
<h3><a class="toc-backref" href="#id67">Launch Acceleo Application</a></h3>
<p>Right-click on an Acceleo module (<tt class="docutils literal">.mtl</tt>) file, then select <em>Run As &gt; Launch
Acceleo Application</em>.</p>
<img alt="../images/acceleo_runas.png" src="../images/acceleo_runas.png" />
<p>This opens a wizard to create a launch configuration if such a configuration
does not already exist for this file.</p>
<img alt="../images/acceleo_launch_config1.png" src="../images/acceleo_launch_config1.png" />
<p>If a launch configuration already exists, the generation is launched immediately.</p>
<p><strong>Note:</strong> If an invalid launch configuration exists for the selected Acceleo
module, it is used even if it produces no result or an error. So, if nothing
happened when following the preceding steps, try and check whether a launch
configuration already exists for your template.</p>
<p>Now, let's examine what information must (or can) be provided to Acceleo launch
configurations.</p>
</div>
<div class="section" id="launch-configurations">
<h3><a class="toc-backref" href="#id68">Launch Configurations</a></h3>
<p>Launch configurations for Acceleo can be created as described above, or by
opening the <em>Run Configurations</em> window, and then right-clicking on the <em>Acceleo
Application</em> category to the left, and selecting <em>New</em> or <em>Duplicate</em>.</p>
<p>An acceleo launch configuration requires:</p>
<ul>
<li><p class="first">A project (which contains the java entry point to run)</p>
</li>
<li><p class="first">A java class to run (contained in the above project)</p>
</li>
<li><p class="first">An input model</p>
<img alt="../images/acceleo_launch_config2.png" src="../images/acceleo_launch_config2.png" />
</li>
<li><p class="first">An output folder (which will be the &quot;root&quot; from which to resolve relative paths
of the files that are to be generated)</p>
<img alt="../images/acceleo_launch_config3.png" src="../images/acceleo_launch_config3.png" />
</li>
</ul>
<p>Optionally, properties can be specified directly in the launch configuration.
Here is what a ready launch configuration looks like:</p>
<img alt="../images/acceleo_launch_config4.png" src="../images/acceleo_launch_config4.png" />
<p><strong>Note:</strong> The &quot;Arguments&quot; tab shows that the model and target arguments are
simply text arguments passed to the java class that handles the generation.</p>
<img alt="../images/acceleo_launch_config5.png" src="../images/acceleo_launch_config5.png" />
<div class="section" id="execution-environment">
<h4><a class="toc-backref" href="#id69">Execution environment</a></h4>
<p>There are two ways to run an Acceleo generation in eclipse.
This can be parameterized in the launch configuration, in the field &quot;Runner&quot;:</p>
<img alt="../images/acceleo_launch_config_runner.png" src="../images/acceleo_launch_config_runner.png" />
<p>The <strong>Acceleo Plug-in Application</strong> mode runs the generation inside eclipse.
In this mode, The Acceleo engine uses eclipse APIs to manipulate resources.
Besides, generated files are refreshed in eclipse at the end of the generation.
In this mode, debugging stops on Acceleo module breakpoints, but not on java
code breakpoints.
The &quot;Result view&quot; is populated.
In short, this is the recommended mode to use during the development process of
Acceleo modules.</p>
<p>The <strong>Java Application</strong> mode runs the generation as if it were run outside of
eclipse. In this mode, the Acceleo engine uses only core java features, such as
<tt class="docutils literal">java.io.File</tt> for manipulating files.
As for the generated files, they are not refreshed in eclipse, and the &quot;Result&quot;
view is not populated:
The generation is actually completely unaware of the running eclipse.
Contrary to the previous mode, breakpoints located in java services called from
your templates are taken into account, but breakpoints located in Acceleo
templates are not.
Consequently, this is the recommended mode for testing and validating Acceleo
modules to make sure they behave as expected when run outside of eclipse.</p>
</div>
</div>
<div class="section" id="the-generated-api">
<h3><a class="toc-backref" href="#id70">The Generated API</a></h3>
<p>To help users, Acceleo creates an API that can launch an Acceleo template.
This API can easily be customized to fit your specificities, if any.</p>
<p>It is important to note that Acceleo inspects modules for <tt class="docutils literal">&#64;main</tt>
annotations in comments, and treats those templates specially.
For every module containing at least one <tt class="docutils literal">&#64;main</tt> annotation, a java file
is generated alongside it. This class contains whatever plumbing code
is needed to run the generator.</p>
<p><strong>Note:</strong>
Templates marked with an <tt class="docutils literal">&#64;main</tt> annotation can be used to encapsulate the
workflow logic of your generation.</p>
<p>The generation can then be run by calling the main() method of the generated
class, or instantiating it and calling <tt class="docutils literal">doGenerate()</tt>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">API</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal">&lt;constructor&gt;</tt></td>
<td><p class="first">Three constructors are generated by default:</p>
<ul class="last simple">
<li>One which receives:<ul>
<li>The input model's URI;</li>
<li>The target folder (as a java.io.File);</li>
<li>A list of arguments (as a java.util.List);</li>
</ul>
</li>
<li>Another which receives the model's root element instead of the
model's URI</li>
<li>A default one which just allows an easy instantiation, but
requires one of the <tt class="docutils literal">initialize</tt> methods to be called before
generating anything.</li>
</ul>
</td>
</tr>
<tr><td><tt class="docutils literal">main()</tt></td>
<td>A java entry point which can be used to launch a standalone
generation (outside of eclipse).</td>
</tr>
<tr><td><tt class="docutils literal">doGenerate()</tt></td>
<td>Launches the generation, using the given EMF progression monitor.</td>
</tr>
<tr><td><tt class="docutils literal">getGenerationListeners()</tt></td>
<td>Entry point that allows users to provide listeners of generation
events if needed.</td>
</tr>
<tr><td><tt class="docutils literal">getGenerationStrategy()</tt></td>
<td>Entry point that allows users to change the way files are
generated. Files can be generating using a <tt class="docutils literal">DefaultStrategy</tt>, a
<tt class="docutils literal">PreviewStrategy</tt> or a <tt class="docutils literal">WorkspaceAwareStrategy</tt>, depending on
what and where the generation must be run.
Just return the right type of strategy, and refer to the
generated javadoc for more details.</td>
</tr>
<tr><td><tt class="docutils literal">getModuleName()</tt></td>
<td>Returns the module name without file extension.
The default implementation should be convenient in most cases.</td>
</tr>
<tr><td><tt class="docutils literal">getProperties()</tt></td>
<td>This method allows you to add properties or properties files that
will subsequently be available during the generation.</td>
</tr>
<tr><td><tt class="docutils literal">getTemplateNames()</tt></td>
<td>Returns the list of templates to call during the generation process
The default implementation should be convenient in most cases.</td>
</tr>
<tr><td><tt class="docutils literal">registerPackages()</tt></td>
<td>Allows you to register EMF packages depending on the metamodels you
need in your generators.
This is only useful when launching standalone generations.
This will be necessary if you use UML for example.
You need to register every EMF package URI that is necessary to
load the models you use.
Refer to the EMF documentation if the meaning of this section is
unclear.</td>
</tr>
<tr><td><tt class="docutils literal">registerResourcefactories()</tt></td>
<td>Can be used to update the resource set's resource factopry registry
with all needed  factories. For advanced users only!
This is only useful when launching standalone generations.
This will be necessary if you use UML or any other metamodel that
has its own resource factory.
Refer to the EMF documentation if the meaning of this section is
unclear.</td>
</tr>
</tbody>
</table>
<div class="section" id="customizing-acceleo-generations-with-properties">
<h4><a class="toc-backref" href="#id71">Customizing Acceleo Generations with Properties</a></h4>
<p>It is very convenient to use properties to parameterize portions of generators
or even generation rules.
For example, properties can be used to parameterize which elements need be
generated, making it easy to regenerate only a subset of files if required.
This can also be used for internationalization.</p>
<p>Properties must be provided via the <tt class="docutils literal"><span class="pre">getProperties()``API,</span> which returns a
``java.util.List&lt;String&gt;</tt>.
The returned list must contain the qualified names of the resource bundles from
which the properties will be read, without extensions.</p>
<p>For example, returning &quot;org.eclipse.acceleo.module.sample.My&quot; will
have Acceleo looking for:</p>
<ul class="simple">
<li>A class named <tt class="docutils literal">org.eclipse.acceleo.module.sample.My</tt> that implements
<tt class="docutils literal">ResourceBundle</tt>;</li>
<li>A properties file named <tt class="docutils literal">My.properties</tt> in the
<tt class="docutils literal">org/eclipse/acceleo/module/sample/</tt> source folder;</li>
<li>Properties files named <tt class="docutils literal">My_en.properties</tt>, <tt class="docutils literal">My_fr.properties</tt>, and so on
depending on possible locales in the <tt class="docutils literal">org/eclipse/acceleo/module/sample/</tt>
source folder.</li>
</ul>
<p>The mechanism used by Acceleo is that of <tt class="docutils literal">ResourceBundle</tt>, which is a standard
and widespread java mechanism. Please refer to your JDK's javadoc for more
information about resource bundles and properties files.</p>
<p><strong>Note</strong>: The resource bundles (i.e. properties files) must be accessible by the
class loader used, so the simplest way is to put them in the module's class
path.</p>
</div>
<div class="section" id="generation-strategies">
<h4><a class="toc-backref" href="#id72">Generation Strategies</a></h4>
<p>For the time being, Acceleo proposes 3 generations strategies:</p>
<ul class="simple">
<li>The <tt class="docutils literal">DefaultStrategy</tt> generates files on disk gradually during the whole
generation process;</li>
<li>The <tt class="docutils literal">PreviewStrategy</tt> generates no file at all, but returns a
<tt class="docutils literal">java.util.Map&lt;String, String&gt;</tt> in which keys are the file names and values
are generated code for these files;</li>
<li>The <tt class="docutils literal">WorkspaceAwareStrategy</tt> generates in memory, then asks elipse whether
output files can be overridden. (This is an SCM-friendly mode, which works
well with, for instance, ClearCase).</li>
</ul>
<p>Just use a new instance of the right strategy and return it in your
implementation of the <tt class="docutils literal">getGenerationStrategy()</tt> method.</p>
<p><strong>Note</strong>: The generation strategy mechanism is API and you can create your own
subclasses in the unlikely case that the three Acceleo proposes aren't sufficient
for your needs.</p>
</div>
</div>
<div class="section" id="using-the-result-view">
<h3><a class="toc-backref" href="#id73">Using the Result View</a></h3>
<p>As mentioned above, the Result View displays the result of the latest Acceleo
generation run.</p>
<p>Let's suppose we have the following Acceleo module to generate a class:</p>
<img alt="../images/acceleo_result_view0.png" src="../images/acceleo_result_view0.png" />
<p>Let's run this on a UML model that contains two classes <tt class="docutils literal">User</tt> and
<tt class="docutils literal">Account</tt>. It generates two java files, and the Result view looks like this:</p>
<img alt="../images/acceleo_result_view1.png" src="../images/acceleo_result_view1.png" />
<p>As you can see, each generated file appears in its project and folder hierarchy.</p>
<p>Inside of each generated file, the model elements used to generate it appear
first, followed by the Acceleo module used to generate it.</p>
<p>What is really useful with this view is the synchronization between the
generated code, the model elements used, and the templates.</p>
<p>For example, double-clicking on model element in this view (say, on &quot;User&quot;)
automatically opens the corresponding generated code.</p>
<img alt="../images/acceleo_result_view_synchro1.png" src="../images/acceleo_result_view_synchro1.png" />
<p>It is also possible to open the input UML model on this specific element, by
right-clicking on it, then selecting <em>Open Declaration</em>.</p>
<img alt="../images/acceleo_result_view_open_declaration.png" src="../images/acceleo_result_view_open_declaration.png" />
<p>The associated model element is then displayed in the editor:</p>
<img alt="../images/acceleo_result_view_synchro1b.png" src="../images/acceleo_result_view_synchro1b.png" />
<p>Double-clicking on a template element in this view automatically displays the
corresponding portion of generated code.</p>
<img alt="../images/acceleo_result_view_synchro2.png" src="../images/acceleo_result_view_synchro2.png" />
<p>Once again, right-click and select <em>Open Declaration</em> to open the associated
Acceleo module, with the relevant portion of template highlighted.</p>
<img alt="../images/acceleo_result_view_synchro2b.png" src="../images/acceleo_result_view_synchro2b.png" />
<p>When you click on a portion of generated code in the editor, the associated
template is simultaneously selected in the Result view, and vice-versa.</p>
<p>Notice the little Acceleo markers in the left margin of the generated files:
They indicated portions of text generated by different templates. When you hover
these markers with the mouse, a tooltip appears to explain with which elements
it is related in the model and in the templates. Clicking on it synchronizes the
Result view with the related portion of generated text.</p>
<img alt="../images/acceleo_result_view_synchro3.png" src="../images/acceleo_result_view_synchro3.png" />
<p>The Result view is very useful to understand where unexpected results in your
generated code come from. By just selecting the unexpected text, you'll be able
to know which model element and which template(s) created it.</p>
</div>
<div class="section" id="standalone-execution">
<h3><a class="toc-backref" href="#id74">Standalone Execution</a></h3>
</div>
</div>
<div class="section" id="debugging-an-acceleo-generation">
<h2><a class="toc-backref" href="#id75">Debugging an Acceleo Generation</a></h2>
<div class="section" id="breakpoints">
<h3><a class="toc-backref" href="#id76">Breakpoints</a></h3>
<p>To add a breakpoint somewhere in a template, just double-click in the left
margin on the line where you want to add the breakpoint. A nice bluish marker
should appear, which should be very familiar to eclipse users.</p>
<img alt="../images/acceleo_debug_breakpoint1.png" src="../images/acceleo_debug_breakpoint1.png" />
<p>You can add conditions on breakpoints, so that execution will only stop at the
breakpoint if a given condition is fulfilled. To put a condition on a
breakpoint, just left-click on it once. A small window should appear where you
can enter your condition (using OCL).</p>
<img alt="../images/acceleo_debug_breakpoint2.png" src="../images/acceleo_debug_breakpoint2.png" />
</div>
<div class="section" id="step-by-step-execution">
<h3><a class="toc-backref" href="#id77">Step by Step Execution</a></h3>
<p>To debug an Acceleo generation, two possibilities:</p>
<ul class="simple">
<li>Right-click on your <tt class="docutils literal">.mtl</tt> file, and select
<em>Debug As &gt; Launch Acceleo Generation</em>;</li>
</ul>
<img alt="../images/acceleo_debug_debugas_launch.png" src="../images/acceleo_debug_debugas_launch.png" />
<ul class="simple">
<li>If you have already run the generation you want to debug, click on the debug
icon and select your generation.</li>
</ul>
<p>Eclipse may display a pop-up window to ask you whether you want to open the
debug perspective:</p>
<img alt="../images/acceleo_debug_confirm_perspective_switch.png" src="../images/acceleo_debug_confirm_perspective_switch.png" />
<p>It is actually recommended to switch to the debug perspective, which is really
more appropriate to debug executions.</p>
<p>The debug perspective should be quite familiar to people used to the eclipse
IDE. The &quot;Debug&quot; view (on the top left) displays the stack of the current
execution. Clicking on any element of the stack will simulatenously display the
corresponding Acceleo code in the edition area.</p>
<p>The &quot;Variables&quot; view displays currently accessible variables. In the example
below, the execution has met a breakpoint when computing <tt class="docutils literal">javaType()</tt> for a
class attibute, so the current input is a class attribute (of type <tt class="docutils literal">Property</tt>
in UML2). The &quot;Variables&quot; view tells us that the current attribute is called
&quot;firstName&quot;.</p>
<img alt="../images/acceleo_debug_execution1.png" src="../images/acceleo_debug_execution1.png" />
<p>As usual, it is possible to:</p>
<ul class="simple">
<li>Step into a template (<em>F5</em>);</li>
<li>Step over a template (<em>F6</em>);</li>
<li>Step Return (<em>F7</em>), which means &quot;go to the end of the current template&quot;;</li>
<li>Resume execution (<em>F8</em>);</li>
<li>Stop execution (<em>Ctrl + F2</em>).</li>
</ul>
<p>The icons above the &quot;Debug&quot; view serve the same purpose.</p>
<p>On each step, the debugger stops just before the evaluation, and just after, in
which case it displays the produced text in a field called &quot;output&quot; in the
&quot;Variables&quot; view.</p>
<img alt="../images/acceleo_debug_execution2.png" src="../images/acceleo_debug_execution2.png" />
<p>Acceleo breakpoints can be temporarily deactivated, thanks to the &quot;Breakpoints&quot;
view. Just uncheck the checkbox in front of a breakpoint to deactivate it. Here
is an example of a deactivated breakpoint in this view:</p>
<img alt="../images/acceleo_debug_execution3.png" src="../images/acceleo_debug_execution3.png" />
</div>
</div>
<div class="section" id="profiling-an-acceleo-generation">
<h2><a class="toc-backref" href="#id78">Profiling an Acceleo Generation</a></h2>
<p>Acceleo ships with a built-in profiler which allows you to keep track of
executions and see where time is consumed during a generation, thus making it
easier to identify (and hopefully fix) bottlenecks.</p>
<div class="section" id="profile-configurations">
<h3><a class="toc-backref" href="#id79">Profile Configurations</a></h3>
<p>The first thing to do to profile an Acceleo generation is to create a &quot;Profile
Configuration&quot;, which is as we will see very similar to a Launch Configuration.</p>
<p>To create a Profile Configuration, right-click on an Acceleo module file, and
select <em>Profile As &gt; Profile Configurations...</em>.</p>
<img alt="../images/acceleo_profiling_configurations1.png" src="../images/acceleo_profiling_configurations1.png" />
<p>A configuration page appears, which looks very much like the traditional launch
configuration page. Actually, there is just one additional information to enter,
which is the path to the profiling result file where Acceleo will store the
profiling information of subsequent executions.</p>
<img alt="../images/acceleo_profiling_configurations2.png" src="../images/acceleo_profiling_configurations2.png" />
<p>Profile files must have the file extension <tt class="docutils literal">.mtlp</tt>. If you try another file
extension, the configuration page displays an error message and the
configuration cannot be saved.</p>
<img alt="../images/acceleo_profiling_configurations3.png" src="../images/acceleo_profiling_configurations3.png" />
</div>
<div class="section" id="acceleo-profile-files">
<h3><a class="toc-backref" href="#id80">Acceleo Profile Files</a></h3>
<p>Acceleo stores the result of a profiled execution in a file which extension is
<tt class="docutils literal">.mtlp</tt>. This file is actually just a serialized EMF model.</p>
<p>To profile an Accele generation, you have to launch it by right-clicking on the
Acceleo module file and selecting <em>Profile As &gt; Launch Acceleo Application</em>.</p>
<img alt="../images/acceleo_profiling_launch.png" src="../images/acceleo_profiling_launch.png" />
<p>The generation is then executed, and the profile result file is created (or
updated if it was already there).</p>
<p>Let's take a closer look at it.</p>
<img alt="../images/acceleo_profiling_file2.png" src="../images/acceleo_profiling_file2.png" />
<p>The above image shows the content of an <tt class="docutils literal">mtlp</tt> file, and correspondances
between the generated files or the Acceleo template elements and the profiled
data.</p>
<p>For each generated file, there is one entry in the root node of the profile (see
the main blue and green areas).</p>
<p>Inside of each generated file block, there is profiling information for each
template instruction. The containment of profiled data follows the structure of
executed templates. For example, a <tt class="docutils literal">[for]</tt> instruction contains other template
calls, so the profiled data has a node for the <tt class="docutils literal">for</tt> which contains a node
for each template call executed inside this <tt class="docutils literal">for</tt>.</p>
<p>So, by looking at the profiling data, we know that the generation of the first
file (the blue one) took 20ms, while the second file's generation took 11ms.
For the first file, 60% of the generation time was used in the <tt class="docutils literal">for</tt> loop
that manages the class attributes.</p>
</div>
</div>
</div>
<div class="section" id="deployment">
<h1><a class="toc-backref" href="#id81">Deployment</a></h1>
<div class="section" id="exporting-generator-projects-as-plug-ins">
<h2><a class="toc-backref" href="#id82">Exporting Generator Projects as Plug-ins</a></h2>
<p>Acceleo Projects are eclipse plug-in projects. As such, they need to be exported
as plug-ins in order to be deployed or made available to others.</p>
<p>To do this, just right-click in the package explorer view, click on <em>Export...</em>
and select <em>Plug-in Development &gt; Deployable plug-ins and fragments</em>.</p>
<p>The following wizard page appears:</p>
<img alt="../images/acceleo_export_deployable_plugin1.png" src="../images/acceleo_export_deployable_plugin1.png" />
<p>Click <em>Next &gt;</em> and select the projects to export as deployable plug-ins.
Projects that were selected in the package explorer are already selected.
Enter the destination of export which can be a directory, an archive file or an
eclipse host repository.</p>
<img alt="../images/acceleo_export_deployable_plugin2.png" src="../images/acceleo_export_deployable_plugin2.png" />
<p>Click on <em>Finish</em>, and the selected projects are exported in the chosen
destination.</p>
<p>This looks like the usual way of exporting plug-ins, and it actually is, but
behind the scenes, Acceleo has a few special treatments to run during the export
to make sure the plug-ins will run smoothly after deployment.</p>
<p><strong>Note</strong>: You must select a coherent set of projects for the export
to work right. Especially if you want to export a project that depends on
others, the dependent projects must be selected too.</p>
<p>As usual with plug-ins, they can be aggregated in features, themselves possibly
bundled in update sites. For more information about plug-in deployment, refer
to the eclipse PDE documentation.</p>
<p>As described in section <a class="reference internal" href="#creating-an-acceleo-ui-project">Creating an Acceleo UI Project</a>, Acceleo provides
facilities to create an eclipse plug-in that makes it possible to run your
generators via an eclipse action that appears in a pop-up menu.</p>
<p>These projects can be exported, bundled, or deployed like any other plug-in.</p>
</div>
<div class="section" id="miscellaneous">
<h2><a class="toc-backref" href="#id83">Miscellaneous</a></h2>
<p>It is important to understand that, because of limitations of older versions of
OCL that ship with older versions of eclipse, Acceleo modules may compile well
in eclipse 3.6 but not in eclipse 3.5 or 3.4.</p>
<p>There is a topic about this on <a class="reference external" href="http://wiki.eclipse.org/Acceleo#Compatibility">the Acceleo wiki site, paragraph &quot;Compatibility&quot;</a>.</p>
<p>In some cases, Acceleo modules compiled on eclipse 3.5 will work in eclipse 3.4
even if they would not compile in eclipse 3.4!</p>
</div>
</div>
</div>
</body>
</html>
